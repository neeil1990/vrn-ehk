(function(){"use strict";if(!BX.Sale)BX.Sale={};if(BX.Sale.Yandexcheckout)return;BX.Sale.Yandexcheckout={init:function(t){this.formNode=BX(t.formId);this.paysystemBlockNode=BX(t.paysystemBlockId);this.ajaxUrl=t.ajaxUrl;this.paymentId=t.paymentId;this.paySystemId=t.paySystemId;this.bindEvents()},bindEvents:function(){BX.bind(this.formNode,"submit",BX.proxy(this.sendRequest,this))},sendRequest:function(t){t.preventDefault();var e,n=this.getAllFormData(),i;e={sessid:BX.bitrix_sessid(),PAYMENT_ID:this.paymentId,PAYSYSTEM_ID:this.paySystemId};for(i in n){if(n.hasOwnProperty(i)){e[i]=n[i]}}BX.ajax({method:"POST",dataType:"json",url:this.ajaxUrl,data:e,onsuccess:BX.proxy(function(t){if(t.status==="success"){this.updateTemplateHtml(t.template)}else if(t.status==="error"){this.showErrorTemplate(t.errors)}},this)})},getAllFormData:function(){var t=BX.ajax.prepareForm(this.formNode),e;for(e in t.data){if(t.data.hasOwnProperty(e)&&e===""){delete t.data[e]}}return!!t&&t.data?t.data:{}},updateTemplateHtml:function(t){var e=BX.processHTML(t);BX.loadCSS(e["STYLE"]);this.paysystemBlockNode.innerHTML=e["HTML"];for(var n in e["SCRIPT"]){if(e["SCRIPT"].hasOwnProperty(n)){BX.evalGlobal(e["SCRIPT"][n]["JS"])}}},showErrorTemplate:function(t){var e="";for(var n in t){if(t.hasOwnProperty(n)){e+=t[n]+"<br>"}}var i=document.createElement("div");i.innerHTML=e;i.classList.add("alert");i.classList.add("alert-danger");this.paysystemBlockNode.innerHTML="";this.paysystemBlockNode.appendChild(i)},PaymentPhoneForm:function(t){this.init=function(t){this.phoneFormatDataUrl=t.phoneFormatDataUrl||null;this.phoneCountryCode=t.phoneCountryCode||null;this.form=BX(t.form);if(this.form){this.initPhoneControls()}};this.initPhoneControls=function(){var t=BX.convert.nodeListToArray(this.form.querySelectorAll(".js-paysystem-yandex-input-phone"));t.forEach(function(t){this.initPhoneControl(t,false)},this)};this.initPhoneControl=function(t){if(!t){return}var e=t.previousElementSibling;var n=t.nextElementSibling;new BXMaskedPhone({url:this.phoneFormatDataUrl,country:this.phoneCountryCode,maskedInput:{input:t,dataInput:n}});this.initDisplayedToDataControlEvents(t,n)};this.initDisplayedToDataControlEvents=function(t,e){BX.bind(t,"blur",function(){BX.fireEvent(e,"blur")});BX.bind(t,"focus",function(){BX.fireEvent(e,"focus")})};this.init(t)}}})();
//# sourceMappingURL=script.map.js